<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Memorial Florilegium</title>
    <link href="css/style.css" rel="stylesheet" />
  </head>
  <script src="js/analytics.js"></script>
  <body>
    <!-- Placeholder for injected header -->
    <div id="header-container"></div>
    <div style="display: flex">
      <div id="sidebar" style="width: 200px; padding: 10px">
        <div id="categoryList">
          <script>
            function loadCategories() {
              fetch("updated-menu.html")
                .then((response) => response.text())
                .then((data) => {
                  const currentPage = window.location.pathname.split("/").pop(); // Get current page
                  const sidebar = document.getElementById("sidebar");
                  sidebar.innerHTML = data;

                  // Modify links
                  const links = sidebar.querySelectorAll(".category");
                  links.forEach((link) => {
                    if (link.getAttribute("data-page") === currentPage) {
                      link.href = "#"; // Replace href with '#'
                    }
                  });
                })
                .catch((error) =>
                  console.error("Error loading categories:", error)
                );
            }

            window.onload = loadCategories;
          </script>
        </div>
      </div>

      <main
        style="
          padding-top: 50px;
          padding-left: 50px;
          padding-right: 50px;
          flex: 1;
        "
      >
        <h2>Welcome</h2>
        <p>
          This Florilegium was initially assembled by The Honorable Lord Stefan
          li Rous (Mark S. Harris) who passed away before I ever had the chance
          to discover it. After learning about his work, I felt inspired to
          carry it forward - honouring his vision by maintaining and curating
          the original articles, while also contributing new ones to continue
          and expand his legacy.
        </p>

        <p>
          What's a `Florilegium'? Literally, it means "a gathering of flowers".
          Florilegia were collections of choice tidbits (from Ovid, Aristotle,
          various popes, church scholars, etc) arranged topically.
        </p>

        <p>
          I hope you find these files useful, interesting, amusing or all three.
        </p>
      
        <h3>How it works</h3>
        <ul>
          <li>Browse categories using the sidebar.</li>
          <li>
            Search by keywords, tags or titles in the sidebar search box. You
            can also click on a tag to view all items with that tag.
          </li>
          <li>
            Click the “Open Article” button on a card to view the file in a new
            tab. From there, you can download your own copy directly from your
            browser.
          </li>
          <li>
            For some entries, you'll see a “Class Recording” button, which opens
            a video in a new tab. These cards may also include handouts,
            resource links, or slide decks—download them the same way as above.
          </li>
        </ul>

        <h3>File Prefix</h3>
        <ul class="list-unstyled">
          <li>
            BIB: A bibliography of book and article titles on a single subject.
          </li>
          <li>
            FAQ: An article file that follows a Frequently Asked Questions
            format.
          </li>
          <li>
            LINK: An article file that contains a list of web links, frequently
            annotated with comments.
          </li>
          <li>
            MSG: usually originating from an email list back and forth, or
            messages copied from a discord/facebook/thread.
          </li>
        </ul>
  <section class="recent-uploads">
          <h2>Recently Added</h2>
          <div id="recentUploads"></div>
        </section>

        <h3>Submit an article</h3>
        <p>
          To submit an article, please
          <a href="mailto:ren.swiftwater@gmail.com"
            >email your text submission directly</a
          >, either in doc/docx or pdf format. Include your name and any SCA
          kingdom or baronial affiliation.
        </p>
      </main>
    </div>

    <!-- Inject header + handle dark mode -->
    <script src="data/header.js"></script>
    <!-- Back to Top Button -->
    <button onclick="scrollToTop()" id="backToTopBtn" title="Go to top">
      ↑ Top
    </button>

    <script>
      // Set category for this page
      window.currentCategory = "Accessory";
    </script>

    <script>
       fetch("data/data.json")
    .then((res) => res.json())
    .then((data) => {
      // Sort by newest upload
      data.sort((a, b) => {
        const dateA = a.uploaded ? new Date(a.uploaded) : new Date("1900-01-01");
        const dateB = b.uploaded ? new Date(b.uploaded) : new Date("1900-01-01");
        return dateB - dateA;
      });

      // Take only the newest 6
      const recent = data.slice(0, 6);

      const container = document.getElementById("recentUploads");

      recent.forEach((item) => {
        // Create the card element
        const card = document.createElement("div");
        card.classList.add("recent-card");

        // If dark mode is active on body, also add dark-mode to this card
        if (document.body.classList.contains("dark-mode")) {
          card.classList.add("dark-mode");
        }

        // Add inner content
        card.innerHTML = `
          <h3>${item.title}</h3>
          <p>${item.description}</p>
          <a href="${item.download_url}" target="_blank">Open Article</a>
        `;

        container.appendChild(card);
      });
    });
      // Show button when scrolled down
      window.onscroll = function () {
        scrollFunction();
      };

      function scrollFunction() {
        const button = document.getElementById("backToTopBtn");
        if (
          document.body.scrollTop > 200 ||
          document.documentElement.scrollTop > 200
        ) {
          button.style.display = "block";
        } else {
          button.style.display = "none";
        }
      }

      // Smooth scroll to top
      function scrollToTop() {
        window.scrollTo({ top: 0, behavior: "smooth" });
      }
    </script>
    <div id="footer-container"></div>
    <script src="data/footer.js"></script>
    <script src="js/synonyms.js"></script>
    <script src="js/script.js"></script>
  </body>
</html>
